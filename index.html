<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ±äº¬è¡Œ 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        starlux: { dark: '#3E3A35', brown: '#6B5B4E', gold: '#C5A572', cream: '#F8F4E3' },
                        sushi: { black: '#1a1a1a', wood: '#e6cda3' },
                        fuji: { blue: '#2c5ea8', white: '#f3f4f6' },
                        toyota: { red: '#eb0a1e' },
                        jr: { red: '#e60012' }, 
                        luger: { red: '#4a0e0e', gold: '#d4af37' }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
        
        body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; padding-bottom: 100px; background-color: #f8fafc; }
        
        /* å¡ç‰‡æ¨£å¼ */
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .flight-card { background: linear-gradient(135deg, #3E3A35 0%, #5d5045 100%); color: #F8F4E3; box-shadow: 0 15px 30px -10px rgba(62, 58, 53, 0.6); border: 1px solid rgba(197, 165, 114, 0.1); }
        .sushi-card { background: #151515; color: #e6cda3; border: 1px solid #333; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); }
        .snoopy-card { background: #fffbf0; border: 2px dashed #8b5e3c; color: #5d4037; }
        .bus-card { background: linear-gradient(135deg, #2c5ea8 0%, #1e4079 100%); color: white; box-shadow: 0 10px 20px -5px rgba(44, 94, 168, 0.4); border-left: 5px solid #fbbf24; }
        .rent-card { border-left: 5px solid #eb0a1e; }
        .fuji-forecast-card { background: linear-gradient(to bottom, #3b82f6 0%, #93c5fd 100%); color: white; position: relative; overflow: hidden; }
        .train-card { background: white; border-left: 6px solid #e60012; border-right: 1px solid #ddd; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .luger-card { background: #4a0e0e; color: #f3e5ab; border: 1px solid #d4af37; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.6); }
        .lounge-card { background: linear-gradient(135deg, #fdfbf7 0%, #fff 100%); border: 1px solid #e5e7eb; border-left: 4px solid #d4af37; }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .page-content, .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .page-content.active, .tab-content.active { display: block; }
        
        .weather-widget { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); border: 1px solid rgba(255, 255, 255, 0.6); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .fuji-bg { position: absolute; bottom: -10px; right: -20px; font-size: 120px; opacity: 0.2; color: white; transform: rotate(-10deg); }

        .check-item { transition: all 0.2s; }
        .check-item.checked span { text-decoration: line-through; color: #9ca3af; }
        .check-item.checked { background-color: #f9fafb; }
        
        .date-btn { transition: all 0.2s; }
        .date-btn.active { transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        .weather-toggle-btn.active-sun { background-color: #fef3c7; color: #d97706; border-color: #d97706; }
        .weather-toggle-btn.active-rain { background-color: #e0f2fe; color: #0284c7; border-color: #0284c7; }
        .weather-plan { display: none; animation: fadeIn 0.4s ease; }
        .weather-plan.active { display: block; }

        /* Budget Payment Buttons Fixed */
        .pay-btn { border: 1px solid #e5e7eb; color: #6b7280; transition: all 0.2s; flex: 1; min-width: 60px; text-align: center; justify-content: center; }
        .pay-btn.active { background-color: #16a34a; color: white; border-color: #16a34a; font-weight: bold; }
        
        /* Input Fixes */
        input[type="number"], input[type="text"] { width: 100%; box-sizing: border-box; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="sticky top-0 z-50 bg-white/95 backdrop-blur-md border-b border-gray-200 shadow-sm">
        <div class="max-w-md mx-auto px-4 pt-3 pb-2">
            <h1 class="text-lg font-bold text-center text-slate-800 mb-2">æ±äº¬ä¹‹æ—… 2025 ğŸ‡¯ğŸ‡µ</h1>
            <div class="flex space-x-2 overflow-x-auto hide-scrollbar pb-1">
                <button onclick="switchPage('list')" id="btn-list" class="date-btn flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap bg-red-50 text-red-500">ğŸ’æ¸…å–®</button>
                <button onclick="switchPage('budget')" id="btn-budget" class="date-btn flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap bg-green-50 text-green-600">ğŸ’°è²»ç”¨</button>
                <button onclick="switchPage('day1')" id="btn-day1" class="date-btn active bg-blue-600 text-white flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap">12/05</button>
                <button onclick="switchPage('day2')" id="btn-day2" class="date-btn bg-gray-100 text-gray-400 flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap">12/06</button>
                <button onclick="switchPage('day3')" id="btn-day3" class="date-btn bg-gray-100 text-gray-400 flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap">12/07</button>
                <button onclick="switchPage('day4')" id="btn-day4" class="date-btn bg-gray-100 text-gray-400 flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap">12/08</button>
                <button onclick="switchPage('day5')" id="btn-day5" class="date-btn bg-gray-100 text-gray-400 flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap">12/09</button>
            </div>
        </div>
    </div>

    <div class="max-w-md mx-auto px-4 py-4">

        <div id="view-list" class="page-content">
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                <h2 class="font-bold text-lg mb-4 flex items-center gap-2 text-red-500"><i class="fas fa-clipboard-check"></i> è¡Œææª¢æŸ¥è¡¨</h2>
                <div class="flex gap-2 mb-4">
                    <input type="text" id="newItemInput" placeholder="è¼¸å…¥é …ç›®..." class="flex-1 border rounded-lg px-3 py-2 text-sm">
                    <button onclick="addItem()" class="bg-red-500 text-white px-4 rounded-lg"><i class="fas fa-plus"></i></button>
                </div>
                <div id="checklist-container" class="space-y-2"></div>
            </div>
        </div>

        <div id="view-budget" class="page-content">
            <div class="bg-gradient-to-r from-green-600 to-emerald-600 p-6 rounded-2xl shadow-lg text-white mb-4 text-center">
                <h3 class="text-xs opacity-80 mb-1">ç¸½æ”¯å‡º (å°å¹£)</h3>
                <div class="text-4xl font-bold">NT$ <span id="total-all-twd">0</span></div>
                <div class="mt-2 pt-2 border-t border-white/20 text-sm opacity-90 flex justify-between px-4">
                    <span>æ—¥å¹£ç¾é‡‘æ”¯å‡º:</span>
                    <span class="font-mono">Â¥ <span id="total-cash-jpy">0</span></span>
                </div>
            </div>

            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                <h4 class="font-bold text-gray-700 mb-4 border-l-4 border-green-500 pl-2">æ–°å¢æ¶ˆè²»</h4>
                <div class="space-y-4">
                    <div>
                        <label class="text-xs text-gray-400 block mb-1">æ¶ˆè²»é …ç›®</label>
                        <input type="text" id="bud-name" placeholder="ä¾‹ï¼šæ™šé¤ã€ä¼´æ‰‹ç¦®" class="w-full border border-gray-300 rounded-lg px-3 py-3 text-base">
                    </div>
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-xs text-gray-400 block mb-1">æ—¥å¹£ (Â¥)</label>
                            <input type="number" id="bud-jpy" placeholder="0" class="w-full border border-gray-300 rounded-lg px-3 py-3 text-base" oninput="autoConvert()">
                        </div>
                        <div class="flex-1">
                            <label class="text-xs text-gray-400 block mb-1">å°å¹£ (NT$)</label>
                            <input type="number" id="bud-twd" placeholder="0" class="w-full border border-gray-300 rounded-lg px-3 py-3 text-base">
                        </div>
                    </div>
                    
                    <div>
                        <label class="text-xs text-gray-400 block mb-2">ä»˜æ¬¾æ–¹å¼</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setPay('ç¾é‡‘')" class="pay-btn py-2 rounded-lg bg-gray-50 text-sm">ç¾é‡‘</button>
                            <button onclick="setPay('è¥¿ç“œå¡')" class="pay-btn py-2 rounded-lg bg-gray-50 text-sm">è¥¿ç“œå¡</button>
                            <button onclick="setPay('Cube')" class="pay-btn py-2 rounded-lg bg-gray-50 text-sm">Cube</button>
                            <button onclick="setPay('å°æ–°')" class="pay-btn py-2 rounded-lg bg-gray-50 text-sm">å°æ–°</button>
                            <button onclick="setPay('ä¸­ä¿¡')" class="pay-btn py-2 rounded-lg bg-gray-50 text-sm">ä¸­ä¿¡</button>
                        </div>
                        <input type="hidden" id="bud-card" value="ç¾é‡‘">
                    </div>

                    <button onclick="addExpense()" class="w-full bg-green-600 text-white py-3 rounded-lg font-bold shadow-md active:scale-95 transition">åŠ å…¥è¨˜å¸³</button>
                </div>
            </div>

            <div id="expense-list" class="space-y-3 mt-4 pb-20"></div>
        </div>

        <div id="view-day1" class="page-content active">
            <div class="weather-widget rounded-xl p-3 flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="text-2xl text-orange-400"><i class="fas fa-cloud-sun"></i></div><div><div class="font-bold text-sm text-gray-800">Tokyo</div><div class="text-xs text-gray-500">Partly Cloudy</div></div></div><div class="text-right"><div class="font-bold text-lg text-gray-800">13Â°<span class="text-sm font-normal text-gray-400"> / 7Â°</span></div></div></div>

            <div class="glass-card rounded-2xl p-4 mb-4">
                <h3 class="font-bold text-gray-800 text-lg mb-2">06:00 å‡ºç™¼å‰å¾€æ©Ÿå ´</h3>
                <p class="text-sm text-gray-500">å“¥å“¥è¼‰åª½åª½ -> å°åŒ—è»Šç«™ -> æ©Ÿæ· -> T1</p>
            </div>

            <div class="flight-card rounded-2xl p-5 mb-4 relative overflow-hidden">
                <div class="relative z-10">
                    <div class="flex justify-between mb-4 border-b border-white/20 pb-2"><span class="font-mono text-xl font-bold">JX802</span><span class="text-xs bg-white/20 px-2 py-1 rounded">STARLUX</span></div>
                    <div class="flex justify-between text-center mb-4"><div><div class="text-3xl font-bold">TPE</div><div class="text-xs opacity-70">10:15</div></div><div class="text-xs opacity-50 pt-2">3h 00m<br>âœˆ</div><div><div class="text-3xl font-bold">NRT</div><div class="text-xs opacity-70">14:15</div></div></div>
                    <div class="bg-black/20 rounded-xl p-3 mb-3 text-sm space-y-1">
                        <div class="flex justify-between"><span>ğŸ’º Seat</span><span class="font-bold">5A</span></div>
                        <div class="flex justify-between"><span>ğŸ´ Meal</span><span class="font-bold text-xs">èƒ¡åŒæ—¥æœ¬å’Œç‰›è‡€è‚‰ä¸Šè“‹ç‰›æ’</span></div>
                    </div>
                    <div class="bg-[#F8F4E3] text-[#3E3A35] rounded-xl p-3 flex justify-between items-center cursor-pointer active:scale-95 transition" onclick="copyCode('2MZCN7')">
                        <div><div class="text-[10px] font-bold">BOOKING REF</div><div class="font-mono font-bold">2MZCN7</div><div class="text-[10px]">Tung Chia Jung</div></div>
                        <i class="far fa-copy text-xl opacity-50"></i>
                    </div>
                    <a href="https://www.starlux-airlines.com/zh-TW/booking/manage-my-trip/manage-my-trip" target="_blank" class="mt-3 block text-center text-xs border border-white/30 rounded py-2 hover:bg-white/10">è¡Œç¨‹ç®¡ç†</a>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-blue-600">
                <h3 class="font-bold text-lg">æ±æ©«INN å—ç”ºç”°</h3>
                <p class="text-xs text-gray-500">Toyoko Inn Minami-Machida</p>
                <a href="https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Minami-Machida" target="_blank" class="mt-2 block text-right text-xs text-blue-500 underline">æŸ¥çœ‹ä½ç½®</a>
            </div>
        </div>

        <div id="view-day2" class="page-content">
            <div class="weather-widget rounded-xl p-3 flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="text-2xl text-orange-500"><i class="fas fa-sun"></i></div><div><div class="font-bold text-sm text-gray-800">Tokyo</div><div class="text-xs text-gray-500">Sunny</div></div></div><div class="text-right"><div class="font-bold text-lg text-gray-800">12Â°<span class="text-sm font-normal text-gray-400"> / 5Â°</span></div></div></div>

            <div class="bg-gray-200 p-1 rounded-xl flex text-sm font-medium mb-4">
                <button onclick="toggleTab('brother')" class="flex-1 py-2 rounded-lg bg-white shadow-sm">å“¥å“¥</button>
                <button onclick="toggleTab('mom')" class="flex-1 py-2 rounded-lg text-gray-500">åª½åª½</button>
            </div>

            <div id="tab-brother" class="space-y-4">
                <div class="glass-card rounded-2xl p-4 border-l-4 border-indigo-500">
                    <h3 class="font-bold">å°åŒ—å‡ºç™¼</h3><p class="text-sm text-gray-500">Taxi -> å—æ¸¯ -> åŒ—è»Š -> æ¡ƒæ©Ÿ T1</p>
                </div>
                <div class="flight-card rounded-2xl p-5 relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex justify-between mb-4 border-b border-white/20 pb-2"><span class="font-mono text-xl font-bold">JX802</span><span class="text-xs bg-white/20 px-2 py-1 rounded">STARLUX</span></div>
                        <div class="flex justify-between text-center mb-4"><div><div class="text-3xl font-bold">TPE</div><div class="text-xs opacity-70">10:15</div></div><div><div class="text-3xl font-bold">NRT</div><div class="text-xs opacity-70">14:15</div></div></div>
                        <div class="bg-black/20 rounded-xl p-3 mb-3 text-sm space-y-1">
                            <div class="flex justify-between"><span>ğŸ’º Seat</span><span class="font-bold">20A</span></div>
                            <div class="flex justify-between"><span>ğŸ´ Meal</span><span class="font-bold text-xs">è¶Šå¼çƒ¤è±¬è‚‰ç±³ç·šä½è’œè¾£é­šéœ²é†¬</span></div>
                        </div>
                        <div class="bg-[#F8F4E3] text-[#3E3A35] rounded-xl p-3 flex justify-between items-center cursor-pointer active:scale-95 transition" onclick="copyCode('2MUDEK')">
                            <div><div class="text-[10px] font-bold">BOOKING REF</div><div class="font-mono font-bold">2MUDEK</div><div class="text-[10px]">Chiu Mu Hsuan</div></div>
                            <i class="far fa-copy text-xl opacity-50"></i>
                        </div>
                        <a href="https://www.starlux-airlines.com/zh-TW/booking/manage-my-trip/manage-my-trip" target="_blank" class="mt-3 block text-center text-xs border border-white/30 rounded py-2 hover:bg-white/10">è¡Œç¨‹ç®¡ç†</a>
                    </div>
                </div>
            </div>

            <div id="tab-mom" class="hidden space-y-4">
                <div class="glass-card rounded-2xl p-4 border-l-4 border-yellow-500">
                    <h3 class="font-bold">å²åŠªæ¯”åšç‰©é¤¨</h3><p class="text-sm text-gray-500">10:00 é–‹é¤¨ï¼Œæ­¥è¡Œå¯é”</p>
                </div>
                <div class="glass-card rounded-2xl p-4">
                    <h3 class="font-bold">å‰å¾€æ½®è¦‹ç‹å­é£¯åº—</h3>
                    <p class="text-xs text-gray-500">å—ç”ºç”° -> æ¾€è°· -> æ–°æœ¨å ´ -> æ½®è¦‹</p>
                    <a href="https://www.google.com/maps/dir/?api=1&origin=Minami-machida+Grandberry+Park+Station&destination=Tokyo+Bay+Shiomi+Prince+Hotel&travelmode=transit" target="_blank" class="text-xs text-blue-500 underline">Google å°èˆª</a>
                </div>
            </div>

            <div class="relative py-4 text-center"><span class="bg-slate-100 px-4 text-sm text-gray-500 font-bold">å‚æ™šæœƒåˆ</span></div>
            
            <div class="glass-card rounded-2xl p-4 border-l-4 border-orange-400 mb-4">
                <h3 class="font-bold">æ±äº¬ç£æ½®è¦‹ç‹å­å¤§é£¯åº—</h3>
                <p class="text-xs text-gray-500">Tokyo Bay Shiomi Prince Hotel</p>
                 <a href="https://maps.google.com/?q=Tokyo+Bay+Shiomi+Prince+Hotel" target="_blank" class="mt-2 block text-right text-xs text-blue-500 underline">æŸ¥çœ‹ä½ç½®</a>
            </div>

            <div class="sushi-card rounded-2xl p-5 shadow-xl">
                <div class="flex justify-between border-b border-[#e6cda3]/30 pb-2 mb-3"><span class="text-xs tracking-widest">DINNER</span><span class="font-bold text-xl">19:45</span></div>
                <h2 class="text-2xl font-bold text-white mb-1">é®¨ éº»å¸ƒ</h2>
                <div class="bg-[#333]/50 p-3 rounded border border-[#e6cda3]/20 mb-3">
                     <div class="flex justify-between items-center"><span>Ref: <span class="font-mono font-bold">P6GKCD</span></span><button onclick="copyCode('P6GKCD')"><i class="far fa-copy"></i></button></div>
                     <div class="text-xs mt-1 opacity-80">ã‚­ãƒ¥ã‚¦ ãƒœã‚¯ã‚±ãƒ³ | 2ä½ (Counter)</div>
                </div>
                <div class="flex gap-2 mt-3">
                    <a href="https://www.tablecheck.com/zh-TW/account/reservations/upcoming" target="_blank" class="flex-1 text-center text-xs border border-[#e6cda3]/50 text-[#e6cda3] py-2 rounded">TableCheck</a>
                    <a href="https://maps.google.com/?q=Sushi+Azabu+Tokyo" target="_blank" class="flex-1 text-center text-xs border border-[#e6cda3]/50 text-[#e6cda3] py-2 rounded">Map</a>
                </div>
            </div>
            
            <div class="glass-card rounded-2xl p-4 border-l-4 border-indigo-500 mt-4">
                 <h3 class="font-bold text-gray-800">æ±äº¬è»Šç«™å¤œæ™¯æ•£ç­–</h3>
                 <ul class="list-none space-y-2 mt-2 text-sm text-gray-600">
                    <li><span class="font-bold text-indigo-600">6F KITTE</span>: å±‹ä¸Šåº­åœ’ (~22:00)</li>
                    <li><span class="font-bold text-indigo-600">7F æ–°ä¸¸ã®å…§</span>: é¤é£²éœ²è‡º (~23:00)</li>
                    <li class="opacity-60">5F ä¸¸ã®å…§: è§€æ™¯å° (~20:00)</li>
                 </ul>
            </div>
        </div>

        <div id="view-day3" class="page-content">
            <div class="weather-widget rounded-xl p-3 flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="text-2xl text-blue-500"><i class="fas fa-mountain"></i></div><div><div class="font-bold text-sm text-gray-800">Kawaguchiko</div><div class="text-xs text-gray-500">Clear</div></div></div><div class="text-right"><div class="font-bold text-lg text-gray-800">9Â°<span class="text-sm font-normal text-gray-400"> / -1Â°</span></div></div></div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-yellow-500">
                <h3 class="font-bold text-yellow-700">æ±äº¬ç«™æ¡è²·æ”»ç•¥</h3>
                <p class="text-xs text-gray-600 mt-1">1. æ”¹æœ­å…§: Be! FRUITS SANDWICH (å…ˆè²·!)</p>
                <p class="text-xs text-gray-600">2. æ”¹æœ­å¤–: ROKUMEI COFFEE CO.</p>
            </div>

            <div class="bus-card rounded-2xl p-4 mb-4">
                <div class="flex justify-between mb-2 border-b border-white/20 pb-2"><span class="font-bold">å¯Œå£«æ€¥å·´å£« No.117</span><span>10:20 -> 12:22</span></div>
                <div class="flex justify-between text-sm"><span>æ±äº¬å…«é‡æ´²å—</span><span>æ²³å£æ¹–</span></div>
                <div class="bg-black/10 rounded p-2 mt-2 flex justify-between text-sm"><span>1C, 1D</span><span>Â¥4,600 (2äºº)</span></div>
                <a href="https://willer-travel.com/tw/" target="_blank" class="mt-2 block text-center text-xs bg-white/20 py-1 rounded">é ç´„ç¢ºèª</a>
            </div>

            <div class="glass-card rent-card rounded-2xl p-4 mb-4">
                <div class="flex justify-between"><h3 class="font-bold text-gray-800">Toyota Rent a Car</h3><span class="bg-red-600 text-white text-xs px-2 py-1 rounded">GR86</span></div>
                <div class="bg-gray-50 p-3 rounded mt-2 text-sm space-y-2">
                     <div class="flex justify-between"><span>å–: 12/07 13:00</span><span>é‚„: 12/08 13:00</span></div>
                     <div class="flex justify-between items-center pt-2 border-t"><span>é ç´„è™Ÿ: <span class="font-mono font-bold text-red-600">98129619200</span></span><button onclick="copyCode('98129619200')"><i class="far fa-copy"></i></button></div>
                     <div class="flex justify-between"><span>è²»ç”¨</span><span>Â¥18,700</span></div>
                </div>
                <div class="flex gap-2 mt-2">
                    <button onclick="copyCode('161 273 303*05')" class="flex-1 bg-blue-50 text-blue-600 text-xs py-2 rounded">MapCode</button>
                    <a href="./rental.pdf" target="_blank" class="flex-1 bg-gray-800 text-white text-xs py-2 rounded text-center">PDF</a>
                </div>
            </div>

            <div class="fuji-forecast-card rounded-2xl p-4 mb-4 shadow-lg text-center">
                <i class="fas fa-mountain fuji-bg"></i>
                <div class="relative z-10">
                    <h3 class="font-bold text-lg mb-1">å¯Œå£«å±±èƒ½è¦‹åº¦</h3>
                    <span id="fuji-status-badge" class="text-xs bg-white/20 px-2 py-0.5 rounded">Loading...</span>
                    <div class="flex justify-center gap-2 mt-3">
                        <a href="https://fuji-san.info/zh-tw/index.html" target="_blank" class="bg-white text-blue-600 text-xs px-3 py-2 rounded font-bold">å®˜æ–¹æŒ‡æ•¸</a>
                        <a href="https://live.fujigoko.tv/?n=3&t=14&b=&u=&e=&c=" target="_blank" class="bg-black/20 text-white text-xs px-3 py-2 rounded">Live Cam</a>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-orange-500">
                <h3 class="font-bold text-gray-800">ã»ã†ã¨ã†ä¸å‹• æ±æ‹è·¯åº—</h3>
                <p class="text-xs text-gray-500">é›²æœµå»ºç¯‰é¤ºé£¥éºµ (åˆé¤)</p>
                <a href="https://www.google.com/maps/search/?api=1&query=Hoto+Fudo+Higashikoiji" target="_blank" class="text-xs text-orange-500 underline">å°èˆª</a>
            </div>
            
             <div class="mb-4">
                <div class="flex justify-center mb-3">
                    <div class="bg-gray-100 p-1 rounded-xl flex text-sm font-bold">
                        <button onclick="togglePlan('sun')" id="btn-plan-sun" class="weather-toggle-btn active-sun px-4 py-1 rounded-lg">â˜€ï¸ æ™´å¤©</button>
                        <button onclick="togglePlan('rain')" id="btn-plan-rain" class="weather-toggle-btn px-4 py-1 rounded-lg text-gray-400">â˜” é›¨å¤©</button>
                    </div>
                </div>
                <div id="plan-sun" class="weather-plan active bg-orange-50 border border-orange-100 rounded-xl p-3">
                    <h4 class="font-bold text-orange-800 text-sm mb-2">çµ•æ™¯æ”å½±</h4>
                    <ul class="list-disc ml-4 text-sm text-gray-600">
                        <li>è¥¿æ¹– ç™‚ç™’ä¹‹é‡Œ æ ¹å ´</li>
                        <li>Tatego-Hama Beach (è¥¿æ¹–)</li>
                        <li>æœ¬æ –æ¹–å±•æœ›å…¬åœ’ (åƒåœ“éˆ”ç¥¨æ™¯)</li>
                    </ul>
                    <div class="bg-white border border-gray-200 rounded-lg p-2 mt-2 shadow-sm">
                        <h5 class="text-xs font-bold text-gray-500 mb-1">ğŸ“¸ å…‰ç·šæŒ‡å—</h5>
                        <div class="flex justify-between text-xs">
                            <span class="text-amber-600 font-bold">AM: æ²³å£æ¹–ã€å¿é‡</span>
                            <span class="text-blue-600 font-bold">PM: è¥¿æ¹–ã€æœ¬æ –æ¹–</span>
                        </div>
                    </div>
                </div>
                <div id="plan-rain" class="weather-plan bg-blue-50 border border-blue-100 rounded-xl p-3">
                    <h4 class="font-bold text-blue-800 text-sm mb-2">è—æ–‡èˆ‡è³¼ç‰©</h4>
                    <ul class="list-disc ml-4 text-sm text-gray-600">
                        <li>æ²³å£æ¹–éŸ³æ¨‚æ£®æ—</li>
                        <li>ä¹…ä¿ç”°ä¸€ç«¹ç¾è¡“é¤¨</li>
                        <li>Forest Mall (è¶…å¸‚è£œè²¨)</li>
                    </ul>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-blue-800">
                <h3 class="font-bold text-lg text-gray-800">å¯Œå£«åŸæ™¯</h3>
                <p class="text-xs text-gray-500">Fuji Ginkei | 18:00 å¤•é£Ÿ (ä¼šå¸­é¢¨å’Œé£Ÿè†³)</p>
                <div class="mt-2 flex justify-between items-center bg-gray-50 p-2 rounded"><span>Ref: <span class="font-mono font-bold">Y7drQCB</span></span><button onclick="copyCode('Y7drQCB')"><i class="far fa-copy"></i></button></div>
                <div class="text-right text-xs font-bold mt-1">NT$12,765 (Â¥63,650)</div>
                 <a href="https://www.google.com/maps/search/?api=1&query=Toyoko+Inn+Minami-Machida1" target="_blank" class="mt-2 block text-right text-xs text-blue-500 underline">æŸ¥çœ‹ä½ç½®</a>
            </div>
        </div>

        <div id="view-day4" class="page-content">
            <div class="weather-widget rounded-xl p-3 flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="text-2xl text-gray-400"><i class="fas fa-cloud"></i></div><div><div class="font-bold text-sm text-gray-800">Tokyo</div><div class="text-xs text-gray-500">Cloudy</div></div></div><div class="text-right"><div class="font-bold text-lg text-gray-800">11Â°<span class="text-sm font-normal text-gray-400"> / 6Â°</span></div></div></div>

            <div class="glass-card rounded-2xl p-4 border-l-4 border-red-500 mb-4">
                <div class="flex justify-between"><h3 class="font-bold">å¯Œå£«å±±æ—¥å‡º</h3><span class="text-red-500 font-bold">06:41 AM</span></div>
                <p class="text-xs text-gray-500">æ¨è–¦ï¼šæˆ¿é–“å…§æˆ–å¹³é‡ä¹‹æ¿±</p>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-blue-500">
                <h3 class="font-bold">æ—©æ™¨æ”å½±è¡Œç¨‹</h3>
                <ul class="text-sm text-gray-600 space-y-1 mt-1">
                    <li>â€¢ 05:40 Lawson æ²³å£æ¹–ç«™å‰ (è¶äººå°‘)</li>
                    <li>â€¢ 06:40 å¹³é‡ä¹‹æ¿± (æ—¥å‡º/å¤©éµ)</li>
                    <li>â€¢ ç™½é³¥æ¿± (å¦‚æœå¹³é‡äººå¤š)</li>
                    <li>â€¢ å¿é‡å…«æµ· (é †è·¯å¯å»)</li>
                    <li>â€¢ æ–°å€‰å±±æ·ºé–“å…¬åœ’ (Optional)</li>
                    <li>â€¢ 09:30 å¤§çŸ³å…¬åœ’ & Lake Bake Cafe</li>
                </ul>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-orange-500">
                <h3 class="font-bold text-gray-800">IDATEN BETTEI (åˆé¤)</h3>
                <p class="text-xs text-gray-500">æ²³å£æ¹–è»Šç«™é™„è¿‘å¤©å©¦ç¾…</p>
                 <a href="https://maps.app.goo.gl/BWZ7vxqvTcBTi88Q9" target="_blank" class="text-xs text-orange-500 underline">å°èˆª</a>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-green-500">
                <h3 class="font-bold text-gray-800">13:00 é‚„è»Š</h3>
                <p class="text-xs text-gray-500">Toyota Rent a Car å¯Œå£«æ²³å£æ¹–åº—</p>
            </div>

            <div class="train-card rounded-2xl p-4 mb-4">
                <div class="flex justify-between mb-2 border-b pb-2"><span class="font-bold text-red-600">å¯Œå£«å›éŠ 32å·</span><span>14:09 -> 16:07</span></div>
                <div class="flex justify-between text-sm"><span>æ²³å£æ¹–</span><span>æ–°å®¿</span></div>
                <div class="text-xs text-gray-400 text-right mt-1">å·²è³¼ç¥¨ (Klook) NT$1,799</div>
            </div>
            
             <div class="glass-card rounded-2xl p-4 border-l-4 border-green-600 mb-4">
                <div class="flex justify-between items-start"><div><h3 class="font-bold text-lg text-gray-800">all day place shibuya</h3><p class="text-xs text-gray-500 mt-1">æ¾€è°·å…¨å¤©å»£å ´é£¯åº—</p></div><div class="bg-green-100 text-green-700 p-2 rounded-lg text-xs font-bold flex flex-col items-center"><i class="fas fa-key"></i><span>Check In</span></div></div>
                <a href="https://goo.gl/maps/AllDayPlace" target="_blank" class="mt-3 block w-full text-center bg-green-600 text-white text-xs py-2 rounded hover:bg-green-700 transition">æŸ¥çœ‹é£¯åº—ä½ç½®</a>
            </div>

            <div class="luger-card rounded-2xl p-5 mb-4 shadow-xl">
                <div class="flex justify-between border-b border-[#d4af37]/30 pb-2 mb-3"><span class="text-xs tracking-widest">DINNER</span><span class="font-bold text-xl">18:30</span></div>
                <h2 class="font-serif text-2xl font-bold text-[#f3e5ab] mb-1">Peter Luger</h2>
                <div class="bg-black/20 p-3 rounded border border-[#d4af37]/20 mb-3">
                     <div class="flex justify-between items-center"><span>Ref: <span class="font-mono font-bold">MAZZHR</span></span><button onclick="copyCode('MAZZHR')"><i class="far fa-copy"></i></button></div>
                     <div class="text-xs mt-1 opacity-80">ã‚­ãƒ¥ã‚¦ ãƒœã‚¯ã‚±ãƒ³ | 2å | ğŸ‚ Birthday</div>
                </div>
                <div class="text-[10px] bg-[#d4af37]/10 p-2 rounded text-center space-y-1 text-[#f3e5ab]">
                    <div>Steak for Two / Bacon / German Potatoes / Spinach</div>
                </div>
                 <div class="flex gap-2 mt-3">
                     <a href="https://www.tablecheck.com/zh-TW/account/reservations/upcoming" target="_blank" class="flex-1 text-center text-xs border border-[#d4af37]/50 text-[#d4af37] py-2 rounded hover:bg-[#d4af37] hover:text-[#4a0e0e] transition">TableCheck</a>
                     <a href="https://goo.gl/maps/PeterLugerTokyo" target="_blank" class="flex-1 text-center text-xs border border-[#d4af37]/50 text-[#d4af37] py-2 rounded hover:bg-[#d4af37] hover:text-[#4a0e0e] transition">Map</a>
                 </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-purple-600">
                <h3 class="font-bold text-gray-800">æƒ æ¯”å£½èŠ±åœ’å»£å ´å¡”</h3>
                <p class="text-xs text-gray-500">38F å…è²»è§€æ™¯å°ï¼Œçœ‹æ±äº¬éµå¡”å¤œæ™¯ (æ™šé¤å¾Œæ­¥è¡Œ)</p>
            </div>
        </div>

        <div id="view-day5" class="page-content">
            <div class="weather-widget rounded-xl p-3 flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="text-2xl text-orange-500"><i class="fas fa-sun"></i></div><div><div class="font-bold text-sm text-gray-800">Tokyo</div><div class="text-xs text-gray-500">Sunny</div></div></div><div class="text-right"><div class="font-bold text-lg text-gray-800">14Â°<span class="text-sm font-normal text-gray-400"> / 6Â°</span></div></div></div>

            <div class="snoopy-card rounded-2xl p-4 mb-4">
                <h3 class="font-bold text-[#5d4037]">PEANUTS Cafe (åŸå®¿)</h3>
                <p class="text-xs text-[#8b5e3c]">SUNNY SIDE kitchen | æ—©é¤å¾Œå»</p>
                <a href="https://goo.gl/maps/PeanutsCafeHarajuku" target="_blank" class="mt-2 block w-full text-center bg-[#8b5e3c] text-white text-xs py-2 rounded">æŸ¥çœ‹ä½ç½®</a>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-4 border-l-4 border-pink-400">
                <h3 class="font-bold text-gray-800">æœ€å¾Œè¡åˆºï¼šè—¥å¦æ¡è²·</h3>
                <a href="https://www.threads.com/@1han0731/post/DQQjYirj_NC?xmt=AQF0gKb-FVU9Bg2ZQ_7qyuUUrl0XwS2YaH3nM42sD5VQX0S0z3YWGVkBxTWbMbLntoHnuotO&slof=1" target="_blank" class="mt-2 block w-full text-center bg-pink-500 text-white text-xs py-2 rounded shadow-sm">é–‹å•Ÿ Threads æ¨è–¦</a>
            </div>

            <div class="train-card rounded-2xl p-4 mb-4">
                <div class="flex justify-between mb-2 border-b pb-2"><span class="font-bold text-red-600">N'EX æˆç”°ç‰¹å¿«</span><span>12:14 -> 13:23</span></div>
                <div class="flex justify-between text-sm"><span>æ¾€è°·</span><span>æˆç”° T2</span></div>
                <div class="text-xs text-gray-400 text-right mt-1">å·²è³¼ç¥¨ (Reserved)</div>
            </div>

            <div class="bg-gray-200 p-1 rounded-xl flex text-sm font-medium mb-4">
                <button onclick="toggleTabDay5('brother')" class="flex-1 py-2 rounded-lg bg-white shadow-sm">å“¥å“¥ (5K)</button>
                <button onclick="toggleTabDay5('mom')" class="flex-1 py-2 rounded-lg text-gray-500">åª½åª½ (20K)</button>
            </div>

            <div id="tab-brother-d5" class="space-y-4">
                <div class="flight-card rounded-2xl p-5 relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex justify-between mb-4 border-b border-white/20 pb-2"><span class="font-mono text-xl font-bold">JX803</span><span class="text-xs bg-white/20 px-2 py-1 rounded">STARLUX</span></div>
                        <div class="flex justify-between text-center mb-4"><div><div class="text-3xl font-bold">NRT</div><div class="text-xs opacity-70">15:35</div></div><div><div class="text-3xl font-bold">TPE</div><div class="text-xs opacity-70">18:45</div></div></div>
                        <div class="bg-black/20 rounded-xl p-3 mb-3 text-sm space-y-1">
                            <div class="flex justify-between"><span>ğŸ’º Seat</span><span class="font-bold">5K</span></div>
                            <div class="flex justify-between"><span>ğŸ´ Meal</span><span class="font-bold text-xs">äººå½¢ç”ºä»ŠåŠé»‘æ¯›å’Œç‰›è‚©èƒ›å£½å–œç‡’</span></div>
                            <div class="text-xs opacity-70 pt-1">ğŸ¸ ç™½é¶´æ·¡é›ª / åŸ¹èŒ¶æ‹¿éµ / èƒ¡è˜¿è””æ±</div>
                        </div>
                        <div class="bg-[#F8F4E3] text-[#3E3A35] rounded-xl p-3 flex justify-between items-center cursor-pointer active:scale-95 transition" onclick="copyCode('35FLMP')">
                            <div><div class="text-[10px] font-bold">BOOKING REF</div><div class="font-mono font-bold">35FLMP</div><div class="text-[10px]">Chiu Mu Hsuan</div></div>
                            <i class="far fa-copy text-xl opacity-50"></i>
                        </div>
                        <a href="https://www.starlux-airlines.com/zh-TW/booking/manage-my-trip/manage-my-trip" target="_blank" class="mt-3 block text-center text-xs border border-white/30 rounded py-2 hover:bg-white/10">è¡Œç¨‹ç®¡ç†</a>
                    </div>
                </div>
                <div class="glass-card rounded-2xl p-4 border-l-4 border-pink-300">
                    <h3 class="font-bold">ğŸŒ¸ æ«»èŠ±è²´è³“å®¤ (Sakura Lounge)</h3><p class="text-xs text-gray-500">ç¬¬äºŒèˆªå»ˆå—å´ (è¿‘ 61 ç™»æ©Ÿå£)</p>
                </div>
            </div>

            <div id="tab-mom-d5" class="hidden space-y-4">
                <div class="flight-card rounded-2xl p-5 relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex justify-between mb-4 border-b border-white/20 pb-2"><span class="font-mono text-xl font-bold">JX803</span><span class="text-xs bg-white/20 px-2 py-1 rounded">STARLUX</span></div>
                        <div class="flex justify-between text-center mb-4"><div><div class="text-3xl font-bold">NRT</div><div class="text-xs opacity-70">15:35</div></div><div><div class="text-3xl font-bold">TPE</div><div class="text-xs opacity-70">18:45</div></div></div>
                        <div class="bg-black/20 rounded-xl p-3 mb-3 text-sm space-y-1">
                            <div class="flex justify-between"><span>ğŸ’º Seat</span><span class="font-bold">20K</span></div>
                            <div class="flex justify-between"><span>ğŸ´ Meal</span><span class="font-bold text-xs">å’Œé¢¨æ»‘è›‹åšåˆ‡è±¬æ’ä¸¼</span></div>
                        </div>
                        <div class="bg-[#F8F4E3] text-[#3E3A35] rounded-xl p-3 flex justify-between items-center cursor-pointer active:scale-95 transition" onclick="copyCode('3HEG5I')">
                            <div><div class="text-[10px] font-bold">BOOKING REF</div><div class="font-mono font-bold">3HEG5I</div><div class="text-[10px]">Tung Chia Jung</div></div>
                            <i class="far fa-copy text-xl opacity-50"></i>
                        </div>
                         <a href="https://www.starlux-airlines.com/zh-TW/booking/manage-my-trip/manage-my-trip" target="_blank" class="mt-3 block text-center text-xs border border-white/30 rounded py-2 hover:bg-white/10">è¡Œç¨‹ç®¡ç†</a>
                    </div>
                </div>
                <div class="glass-card rounded-2xl p-4 border-l-4 border-gray-500">
                    <h3 class="font-bold">â˜• I.A.S.S Lounge -KoCoo-</h3><p class="text-xs text-gray-500">ç¬¬äºŒèˆªå»ˆä¸»æ¨“ 4F (é¾é¨°å¡)</p>
                </div>
            </div>
        </div>

    </div>

    <div id="toast-container" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 pointer-events-none z-50 w-max"></div>

    <script>
        // --- Tabs Logic ---
        function toggleTab(tab) {
            const bro = document.getElementById('tab-brother');
            const mom = document.getElementById('tab-mom');
            const btnBro = document.querySelector('button[onclick="toggleTab(\'brother\')"]');
            const btnMom = document.querySelector('button[onclick="toggleTab(\'mom\')"]');

            if(tab === 'brother') {
                bro.classList.remove('hidden'); mom.classList.add('hidden');
                btnBro.className = "flex-1 py-2 rounded-lg bg-white shadow-sm font-bold text-indigo-600";
                btnMom.className = "flex-1 py-2 rounded-lg text-gray-500 hover:text-gray-700";
            } else {
                mom.classList.remove('hidden'); bro.classList.add('hidden');
                btnMom.className = "flex-1 py-2 rounded-lg bg-white shadow-sm font-bold text-pink-600";
                btnBro.className = "flex-1 py-2 rounded-lg text-gray-500 hover:text-gray-700";
            }
        }

        function toggleTabDay5(tab) {
            const bro = document.getElementById('tab-brother-d5');
            const mom = document.getElementById('tab-mom-d5');
            const btnBro = document.querySelector('button[onclick="toggleTabDay5(\'brother\')"]');
            const btnMom = document.querySelector('button[onclick="toggleTabDay5(\'mom\')"]');

            if(tab === 'brother') {
                bro.classList.remove('hidden'); mom.classList.add('hidden');
                btnBro.className = "flex-1 py-2 rounded-lg bg-white shadow-sm font-bold text-indigo-600";
                btnMom.className = "flex-1 py-2 rounded-lg text-gray-500 hover:text-gray-700";
            } else {
                mom.classList.remove('hidden'); bro.classList.add('hidden');
                btnMom.className = "flex-1 py-2 rounded-lg bg-white shadow-sm font-bold text-pink-600";
                btnBro.className = "flex-1 py-2 rounded-lg text-gray-500 hover:text-gray-700";
            }
        }

        function togglePlan(type) {
            const sun = document.getElementById('plan-sun');
            const rain = document.getElementById('plan-rain');
            const btnSun = document.getElementById('btn-plan-sun');
            const btnRain = document.getElementById('btn-plan-rain');

            if (type === 'sun') {
                sun.style.display = 'block'; rain.style.display = 'none';
                btnSun.classList.add('active-sun'); btnSun.classList.remove('text-gray-400');
                btnRain.classList.remove('active-rain'); btnRain.classList.add('text-gray-400');
            } else {
                sun.style.display = 'none'; rain.style.display = 'block';
                btnRain.classList.add('active-rain'); btnRain.classList.remove('text-gray-400');
                btnSun.classList.remove('active-sun'); btnSun.classList.add('text-gray-400');
            }
        }

        function switchPage(pageId) {
            document.querySelectorAll('.page-content').forEach(el => el.classList.remove('active'));
            document.getElementById('view-' + pageId).classList.add('active');
            
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-blue-600', 'text-white');
                if(btn.id === 'btn-list') btn.className = "date-btn flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap bg-red-50 text-red-500";
                else if(btn.id === 'btn-budget') btn.className = "date-btn flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap bg-green-50 text-green-600";
                else btn.className = "date-btn bg-gray-100 text-gray-400 flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap";
            });

            const btn = document.getElementById('btn-' + pageId);
            if (pageId === 'list') btn.className = "date-btn active bg-red-500 text-white shadow-lg flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap";
            else if (pageId === 'budget') btn.className = "date-btn active bg-green-600 text-white shadow-lg flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[70px] whitespace-nowrap";
            else btn.className = "date-btn active bg-blue-600 text-white shadow-lg flex-1 py-2 px-3 rounded-xl text-sm font-bold min-w-[60px] whitespace-nowrap";
            
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function copyCode(text) {
            navigator.clipboard.writeText(text).then(() => {
                const div = document.createElement('div');
                div.className = "toast-msg bg-black/80 text-white px-4 py-2 rounded-full fixed bottom-10 left-1/2 -translate-x-1/2 text-sm z-50";
                div.innerHTML = `<i class="fas fa-check mr-2"></i>å·²è¤‡è£½ï¼š${text}`;
                document.body.appendChild(div);
                setTimeout(() => div.remove(), 2000);
            });
        }

        // è¨˜å¸³é‚è¼¯
        function setPay(method) {
            document.getElementById('bud-card').value = method;
            document.querySelectorAll('.pay-btn').forEach(b => {
                b.classList.remove('active', 'bg-green-600', 'text-white');
                b.classList.add('bg-gray-50');
                if(b.innerText === method) {
                    b.classList.remove('bg-gray-50');
                    b.classList.add('active', 'bg-green-600', 'text-white');
                }
            });
        }

        function loadExpenses() {
            const saved = localStorage.getItem('tokyoBudget');
            const expenses = saved ? JSON.parse(saved) : [];
            const list = document.getElementById('expense-list');
            list.innerHTML = '';
            let totalTwd = 0;
            let cashJpy = 0;

            expenses.forEach((ex, i) => {
                const j = parseFloat(ex.j) || 0;
                const t = parseFloat(ex.t) || 0;
                const realTwd = t > 0 ? t : Math.round(j * 0.22);
                totalTwd += realTwd;
                if(ex.c === 'ç¾é‡‘' || ex.c === 'è¥¿ç“œå¡') cashJpy += j;
                
                const div = document.createElement('div');
                div.className = "bg-white p-3 rounded-xl border border-gray-100 shadow-sm flex justify-between items-center";
                div.innerHTML = `<div><div class="font-bold text-gray-800">${ex.n}</div><div class="text-xs text-gray-500">${ex.c}</div></div><div class="text-right"><div class="font-bold">Â¥${ex.j}</div><div class="text-xs text-gray-400">NT$${realTwd}</div></div><button onclick="delExp(${i})" class="ml-3 text-gray-300"><i class="fas fa-trash"></i></button>`;
                list.appendChild(div);
            });
            document.getElementById('total-all-twd').innerText = totalTwd.toLocaleString();
            document.getElementById('total-cash-jpy').innerText = cashJpy.toLocaleString();
        }

        function addExpense() {
            const n = document.getElementById('bud-name').value;
            const j = document.getElementById('bud-jpy').value;
            const t = document.getElementById('bud-twd').value;
            const c = document.getElementById('bud-card').value;
            if(!n) return alert('è«‹è¼¸å…¥é …ç›®');
            const exps = JSON.parse(localStorage.getItem('tokyoBudget')) || [];
            exps.push({n, j: j||0, t: t||0, c});
            localStorage.setItem('tokyoBudget', JSON.stringify(exps));
            document.getElementById('bud-name').value = '';
            document.getElementById('bud-jpy').value = '';
            document.getElementById('bud-twd').value = '';
            loadExpenses();
        }
        
        function delExp(i) {
            const exps = JSON.parse(localStorage.getItem('tokyoBudget'));
            exps.splice(i, 1);
            localStorage.setItem('tokyoBudget', JSON.stringify(exps));
            loadExpenses();
        }
        
        function autoConvert() {
            const j = document.getElementById('bud-jpy').value;
            if(j) document.getElementById('bud-twd').value = Math.round(j * 0.22);
        }

        // æ¸…å–®é‚è¼¯
        const defaultList = ["è­·ç…§", "é§•ç…§(å°/æ—¥)", "æ—¥å¹£ç¾é‡‘", "Visit Japan Web", "è»Šç¥¨/Suica", "Simå¡", "è¡Œå‹•é›»æº/ç·š", "ç›¸æ©Ÿ", "ç¾½çµ¨å¤–å¥—", "ç™¼ç†±è¡£ x3", "å…§è¤² x3", "è¥ªå­ x3", "ç‰™åˆ·/æ´—é¢ä¹³", "å¸¸å‚™è—¥"];
        function loadList() {
            const saved = JSON.parse(localStorage.getItem('tokyoList')) || defaultList.map(t => ({text: t, checked: false}));
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';
            saved.forEach((item, i) => {
                const row = document.createElement('div');
                row.className = `check-item flex items-center gap-3 p-2 rounded border ${item.checked ? 'checked bg-gray-50' : 'bg-white'}`;
                row.onclick = () => { item.checked = !item.checked; localStorage.setItem('tokyoList', JSON.stringify(saved)); loadList(); };
                row.innerHTML = `<div class="w-5 h-5 rounded border flex items-center justify-center ${item.checked ? 'bg-green-500 border-green-500 text-white' : ''}">${item.checked ? 'âœ“' : ''}</div><span class="flex-1 text-sm">${item.text}</span><button onclick="event.stopPropagation(); removeListItem(${i})" class="text-gray-300 px-2">âœ•</button>`;
                container.appendChild(row);
            });
        }
        function addItem() {
            const val = document.getElementById('newItemInput').value;
            if(!val) return;
            const saved = JSON.parse(localStorage.getItem('tokyoList')) || [];
            saved.push({text: val, checked: false});
            localStorage.setItem('tokyoList', JSON.stringify(saved));
            document.getElementById('newItemInput').value = '';
            loadList();
        }
        function removeListItem(i) {
            const saved = JSON.parse(localStorage.getItem('tokyoList'));
            saved.splice(i, 1);
            localStorage.setItem('tokyoList', JSON.stringify(saved));
            loadList();
        }
        function resetList() {
            if(confirm('é‡ç½®æ¸…å–®ï¼Ÿ')) {
                localStorage.removeItem('tokyoList');
                loadList();
            }
        }

        // Init
        loadExpenses();
        loadList();
        setPay('ç¾é‡‘');
        
        // Fetch Weather
        async function initWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=35.49&longitude=138.76&current=cloud_cover');
                const data = await res.json();
                const el = document.getElementById('fuji-status-badge');
                if(el) el.innerText = `${data.current.cloud_cover}% é›²é‡`;
            } catch(e){}
        }
        initWeather();
    </script>
</body>
</html>
